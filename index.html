<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>East Eats</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" type="image/png" href="images/favicon.png">
    <link href='http://fonts.googleapis.com/css?family=Roboto+Condensed' rel='stylesheet' type='text/css'>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCRwEMwFtUHsKuH07WSvvziHAkZa6Nd93Q">
    </script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
    <script type="text/javascript" src="http://oauth.googlecode.com/svn/code/javascript/oauth.js"></script>
    <script type="text/javascript" src="http://oauth.googlecode.com/svn/code/javascript/sha1.js"></script>
    <script type="text/javascript">
      var auth = {
          //
          // Update with your auth tokens.
          //
          consumerKey : "YGvAOYaSuVPLNZQjlnsNEg",
          consumerSecret : "h7Etv1nEP8c8ytZlSdtYPWftNe8",
          accessToken : "MbjXN_q5hbQEY8QZGg00qY3RWOq7fjaC",
          // This example is a proof of concept, for how to use the Yelp v2 API with javascript.
          // You wouldn't actually want to expose your access token secret like this in a real application.
          accessTokenSecret : "739IDgl-a4PLdz5__md3-E028js",
          serviceProvider : {
              signatureMethod : "HMAC-SHA1"
          }
      };

      var terms = 'food';
      var near = 'San+Francisco';

      var accessor = {
          consumerSecret : auth.consumerSecret,
          tokenSecret : auth.accessTokenSecret
      };
      parameters = [];
      parameters.push(['id', 'tanpopo-howick-auckland']);
      //parameters.push(['cc', 'NZ']);
      //parameters.push(['callback', 'cb']);
      //parameters.push(['term', 'food']);
      //parameters.push(['location', 'auckland']);
      parameters.push(['oauth_consumer_key', auth.consumerKey]);
      parameters.push(['oauth_consumer_secret', auth.consumerSecret]);
      parameters.push(['oauth_token', auth.accessToken]);
      parameters.push(['oauth_token_secret', auth.accessTokenSecret]);
      parameters.push(['oauth_signature_method', 'HMAC-SHA1']);

      var message = {
          'action' : 'http://api.yelp.com/v2/business',
          'method' : 'GET',
          'parameters' : parameters
      };

      OAuth.setTimestampAndNonce(message);
      OAuth.SignatureMethod.sign(message, accessor);

      var parameterMap = OAuth.getParameterMap(message.parameters);
      console.log(parameterMap);

      $.ajax({
          'url' : message.action,
          'data' : parameterMap,
          'dataType' : 'jsonp',
          'jsonpCallback' : 'cb',
          'success' : function(data, textStats, XMLHttpRequest) {
              console.log(data);
          }
      });
    </script>
    <script type='text/javascript' src='js/knockout-3.3.0.js'></script>
    <script type='text/javascript' src='js/model.js'></script>
  </head>
  <body>
    <header id="header" class="row">
      <div class="col-11 title">
        <h1 class="col-12">East Eats</h1>
        <h2 class="col-12">Auckland NZ</h2>
      </div>
      <div class="col-1 functions">
        <input class="floatRight  searchBar" type="text" data-bind="value: search, valueUpdate: 'afterkeyup', returnAction: searchResult">
        <button class="floatRight hideButton" data-bind="click: hide, text: hideText"></button>
        <button class="floatRight markerButton" data-bind="click: listFunction">Marker List</button>
      </div>
    </header>
    <div id="mainDiv">
      <div id="markerPanel" class="floatRight">
        <h3 class="markerListHeader">Marker List</h3>
        <ul data-bind="foreach: self.myMap().visibleMarkersList">
          <!-- ko if: visible -->
            <li data-bind="text: title, click: findLocation"></li>
          <!-- /ko -->
        </ul>
      </div>
      <div id="map-canvas" data-bind="map: myMap">
      </div>
    </div>
    <script type='text/javascript' src='js/main.js'></script>
  </body>
</html>
